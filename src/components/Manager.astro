---
import { basics } from '@/jsons/cv-AP.json';
import GitHub from '@/icons/GitHub.astro';
import LinkedIn from '@/icons/LinkedIn.astro';

const { profiles } = basics;
const SOCIAL_ICONS = {
  GitHub,
  LinkedIn,
};

const info = profiles.map(({ network, usernam, url }) => {
  const icon = SOCIAL_ICONS[network];
  const filtroLetra = network[0].toUpperCase();

  return {
    id: network,
    section: 'Redes Sociales',
    title: `Visitar ${network} de ${usernam}`,
    url,
    icon,
    hotkey: `ctrl+${filtroLetra}`,
  };
});
---

<footer class="notPrint">
  Pulsa<kbd>Cmd</kbd> + <kbd>K</kbd> para abrir la paleta de
  comandos
</footer>
<ninja-keys
  class="notPrint"
  placeholder="type a command or search..."
  hideBreadcrumbs
  data-info={JSON.stringify(info)}></ninja-keys>
<script>
  import 'ninja-keys';

  const ninja = document.querySelector('ninja-keys');
  if (ninja != null) {
    const info = ninja.getAttribute('data-info') ?? '[]';
    console.log('info');
    console.log(info);

    const parseInfo = JSON.parse(info);
    console.log('parseInfo');
    console.log(parseInfo);
    const data = parseInfo.map((item) => {
      return {
        ...item,
        handler: () => {
          window.open(item.url, '_blank');
        },
      };
    });

    ninja.data = [
      {
        id: 'print',
        title: 'Imprimir',
        hotkey: 'ctrl+p',
        icon: '',
        section: 'Acciones',
        handler: () => {
          window.print();
        },
      },

      /* para crear un sub menu  */
      {
        id: 'Tema',
        title: 'Cambiar Tema Web',
        icon: '',
        children: [
          'Light Theme',
          'Dark Theme',
          'System Theme',
        ],
        handler: () => {
          ninja.open({ parent: 'Tema' });
          return { keepOpen: true };
        },
      },
      {
        id: 'Light Theme',
        title: 'Cambiar  tema a light',
        icon: '',
        parent: 'Tema',
        handler: () => {
          document.documentElement.classList.remove('dark');
        },
      },
      {
        id: 'Dark Theme',
        title: 'Cambiar tema a Dark',
        icon: '',
        parent: 'Tema',
        handler: () => {
          document.documentElement.classList.add('dark');
        },
      },
      ...data,
    ];
  }
</script>

<style>
  @keyframes fadeIn {
    from {
      opacity: 0;
    }
    to {
      opacity: 1;
    }
  }
  footer {
    z-index: 1;

    background: #fdfdfd;
    border-top: 1px solid #eee;
    position: fixed;
    bottom: 0%;
    width: 100%;
    padding-block: 0.6rem;
    text-align: center;
    font-size: 0.8rem;

    view-timeline-name: --revealing;
    view-timeline-axis: block;

    animation: linear 0.3s fadeIn;
    animation-timeline: --revealing;
    animation-range: entry 100% cover 10%;
  }
  kbd {
    background-color: #eee;
    border: 1px solid #cfcfcfcb;
    border-radius: 4px;
    padding: 2px 4px;
    margin-left: 0.5rem;
    font-weight: 700;
    color: #333;
    box-shadow:
      0 1px 1px rgba(0, 0, 0, 0.2),
      0 2px 0 0 rgba(255, 255, 255, 0.7) inset;
  }
</style>
